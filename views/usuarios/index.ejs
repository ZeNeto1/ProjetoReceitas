<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Lista de Usuários</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <h1>Usuários Cadastrados</h1>
    <a href="/usuarios/novo" class="btn btn-cadastrar">Cadastrar Novo Usuário</a>
    <hr>

    <div class="search-container">
        <form action="/usuarios/search" method="GET">
            <input type="text" name="termo" placeholder="Buscar por nome ou email..." value="<%= typeof termo !== 'undefined' ? termo : '' %>">
            <button type="submit">Pesquisar</button>
            
            <% if (typeof termo !== 'undefined' && termo) { %>
                <a href="/usuarios" class="btn btn-voltar">Limpar busca</a>
            <% } %>
        </form>
    </div>

    <br>

    <% if (usuarios.length > 0) { %>
        <ul>
            <% usuarios.forEach(usuario => { %>
                <li>
                    <strong><%= usuario.nome %></strong> - <%= usuario.email %>
                    <a href="/usuarios/<%= usuario.id %>/editar" class="btn btn-editar btn-sm">Editar</a>

                    <form action="/usuarios/<%= usuario.id %>?_method=DELETE" method="POST"
                          onsubmit="return confirm('Confirma exclusão do usuário <%= usuario.nome %>?');"
                          class="form-inline form-delete">
                        <button type="submit" class="btn btn-deletar btn-sm">Excluir</button>
                    </form>
                </li>
            <% }) %>
        </ul>
    <% } else { %>
        <div class="alerta-vazio">
            <% if (typeof termo !== 'undefined' && termo) { %>
                <p>Nenhum usuário encontrado para a busca: <strong>"<%= termo %>"</strong></p>
                <a href="/usuarios" class="btn btn-voltar">Voltar para a lista completa</a>
            <% } else { %>
                <p>Nenhum usuário cadastrado no sistema.</p>
                <a href="/usuarios/novo" class="btn btn-voltar">Cadastrar o primeiro usuário</a>
            <% } %>
        </div>
    <% } %>
    
    <br>
    <hr>
    <a href="/receitas" class="btn btn-voltar">Voltar ao Catálogo</a>
</body>
</html>